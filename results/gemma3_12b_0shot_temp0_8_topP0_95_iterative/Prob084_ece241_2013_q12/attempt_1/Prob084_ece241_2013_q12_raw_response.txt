```verilog
module TopModule (
  input clk,
  input enable,
  input S,
  input A,
  input B,
  input C,
  output reg Z
);

  reg [7:0] Q;

  always @(posedge clk) begin
    if (enable) begin
      Q <= {S, Q[7:1]};
    end
  end

  always @(*) begin
    case (A * 8 + B * 1 + C)
      3: Z = Q[0];
      4: Z = Q[1];
      5: Z = Q[2];
      6: Z = Q[3];
      7: Z = Q[4];
      8: Z = Q[5];
      9: Z = Q[6];
      10: Z = Q[7];
      default: Z = 0; // Or some other default value if needed.
    endcase
  end

endmodule
```

**Explanation:**

1. **Shift Register:**
   - `reg [7:0] Q;`: Declares an 8-bit register `Q` to hold the shift register's contents.  `Q[0]` is the most significant bit, `Q[7]` is the least significant bit.
   - `always @(posedge clk) begin ... end`: This block describes the sequential logic that updates the shift register on the positive edge of the clock signal.
   - `if (enable) begin ... end`: The shift register updates only when the `enable` input is high.
   - `Q <= {S, Q[7:1]};`: This is the core of the shift register.  It shifts the input `S` into the MSB (`Q[0]`) and shifts the rest of the register one position to the right.

2. **Logic Function Implementation:**
   - `always @(*) begin ... end`: This block describes the combinational logic that selects the output `Z` based on the inputs `A`, `B`, and `C`.
   - `case (A * 8 + B * 2 + C) ... endcase`:  This `case` statement acts as a multiplexer.  It calculates an index based on the values of `A`, `B`, and `C`.
     - `A * 8 + B * 2 + C` converts the 3-bit input (ABC) into a decimal value from 0 to 7.  For example:
       - If ABC = 000, the index is 0.
       - If ABC = 001, the index is 1.
       - If ABC = 010, the index is 2.
       - ...
       - If ABC = 111, the index is 7.
   - `Z = Q[index];`:  The output `Z` is assigned the value of the shift register element at the calculated index. This effectively selects the appropriate bit from the shift register based on the `ABC` inputs.

**How it Works:**

1. **Shift Register Loading:** The shift register is loaded with data bit by bit when `enable` is high and a clock pulse is received.  The input `S` provides the data to be shifted in.
2. **Output Selection:**  The `ABC` inputs act as select lines for a multiplexer. The `case` statement selects one of the bits from the shift register based on the value of `ABC`. The selected bit is then assigned to the output `Z`.

**Example:**

If `A = 0`, `B = 0`, and `C = 0`, then `A * 8 + B * 2 + C = 0`.  The `case` statement selects `Q[0]`, so `Z` will be equal to the value of the MSB of the shift register.

If `A = 0`, `B = 0`, and `C = 1`, then `A * 8 + B * 2 + C = 1`.  The `case` statement selects `Q[1]`, so `Z` will be equal to the value of `Q[1]`.

And so on...
