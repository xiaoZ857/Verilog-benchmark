always @(posedge clk) begin
    if (shift_ena)
        q <= {data, q[2:0]};
    else if (count_ena)
        q <= q - 4'd1;
    else
        q <= q;
end
endmodule